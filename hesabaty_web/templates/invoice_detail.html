{% extends 'base.html' %}
{% block title %}ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙØ§ØªÙˆØ±Ø©{% endblock %}
{% block content %}

<div class="container py-5">
  <div class="card shadow-sm p-4">
    <h4 class="text-center text-primary mb-4">ğŸ“„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø±Ù‚Ù… {{ invoice.id }}</h4>

    <!-- âœ… Ø²Ø± Ø¥Ø¶Ø§ÙØ© Ø¯ÙØ¹Ø© -->
    <div class="text-center mb-4">
      <a href="{% url 'add_payment' %}?invoice_id={{ invoice.id }}" class="btn btn-outline-success">
        â• Ø¥Ø¶Ø§ÙØ© Ø¯ÙØ¹Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù‡Ø°Ù‡ Ø§Ù„ÙØ§ØªÙˆØ±Ø©
      </a>
    </div>

    <!-- âœ… Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙØ§ØªÙˆØ±Ø© -->
    <table class="table table-bordered mt-3">
      <tr><th>Ø§Ù„Ù…Ø³ØªØ£Ø¬Ø±</th><td>{{ invoice.tenant.name }}</td></tr>
      <tr><th>Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</th><td>{{ invoice.tenant.phone_number }}</td></tr>
      <tr><th>Ø§Ù„Ø¹Ù…Ø§Ø±Ø©</th><td>{{ invoice.building.name }}</td></tr>
      <tr><th>Ø§Ù„Ø´Ù‚Ø©</th><td>{{ invoice.apartment.name }}</td></tr>
      <tr><th>Ù†ÙˆØ¹ Ø§Ù„Ø¥ÙŠØ¬Ø§Ø±</th><td>{{ invoice.get_rent_type_display }}</td></tr>
      <tr><th>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th><td>{{ invoice.amount }} Ø±ÙŠØ§Ù„</td></tr>
      <tr><th>Ø§Ù„Ù…Ø¯ÙÙˆØ¹</th><td>{{ invoice.total_paid }} Ø±ÙŠØ§Ù„</td></tr>
      <tr>
        <th>Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹</th>
        <td>
          {% if invoice.is_fully_paid %}
            <span class="badge bg-success">Ù…Ø¯ÙÙˆØ¹</span>
          {% elif invoice.total_paid > 0 %}
            <span class="badge bg-warning text-dark">Ù…Ø¯ÙÙˆØ¹ Ø¬Ø²Ø¦ÙŠØ§Ù‹</span>
          {% else %}
            <span class="badge bg-danger">ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹</span>
          {% endif %}
        </td>
      </tr>
      <tr><th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¯Ø®ÙˆÙ„</th><td>{{ invoice.check_in_datetime|date:"Y-m-d H:i" }}</td></tr>
      <tr><th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø®Ø±ÙˆØ¬</th><td>{{ invoice.check_out_datetime|date:"Y-m-d H:i" }}</td></tr>
      <tr><th>Ø£Ù†Ø´Ø¦Øª Ø¨ÙˆØ§Ø³Ø·Ø©</th><td>{{ invoice.user.username }}</td></tr>
    </table>

    <!-- âœ… Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯ÙØ¹Ø§Øª -->
    {% if invoice.payments.exists %}
      <h5 class="mt-4 mb-2 text-success">ğŸ’³ Ø³Ø¬Ù„ Ø§Ù„Ø¯ÙØ¹Ø§Øª:</h5>
      <ul class="list-group">
        {% for payment in invoice.payments.all %}
          <li class="list-group-item d-flex justify-content-between">
            <span>ğŸ’° {{ payment.amount }} Ø±ÙŠØ§Ù„</span>
            <span class="text-muted">{{ payment.paid_at|date:"Y-m-d H:i" }}</span>
          </li>
        {% endfor %}
      </ul>
    {% endif %}

    <div class="text-center mt-4">
      <a href="{% url 'invoice_list' %}" class="btn btn-outline-dark">â† Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙÙˆØ§ØªÙŠØ±</a>
    </div>
  </div>
</div>

{% endblock %}